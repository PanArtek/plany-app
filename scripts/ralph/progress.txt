# Ralph Progress Log
Started: Fri Feb  6 14:31:55 CET 2026
---

## AKC-001: DB migration - acceptance state machine ✅
- Added sent_at column to projekty
- Recreated rewizje_summary view to include is_accepted/accepted_at (DROP + CREATE needed due to column order change)
- Created change_project_status() RPC with full state machine validation
- Tested: invalid transitions properly raise exceptions, draft→ofertowanie requires locked rewizja

## AKC-002: Server action wrapper ✅
- Created actions/acceptance.ts with changeProjectStatus() calling supabase.rpc()

## AKC-003: Status config + interfaces + StatusBadge extraction ✅
- Updated labels: ofertowanie→'Wysłano do klienta' (blue), realizacja→green, zamkniety→gray
- Added sent_at and accepted_rewizja_id to ProjektBase and ProjektWithCount
- Extracted StatusBadge to separate status-badge.tsx, re-exported from projekty-table.tsx for compatibility

## AKC-004: Projects table Wysłano column ✅
- Added sent_at column accessor between Status and Rewizje columns

## AKC-005 + AKC-006: Action buttons + accept dialog ✅
- Contextual action buttons based on projekt.status (DRAFT/OFERTOWANIE/REALIZACJA/ODRZUCONY/ZAMKNIETY)
- Inline accept revision dialog with locked rewizja selector
- sent_at shown in project data when not null
- All transitions call handleStatusChange with refreshAll after success

## AKC-007: Kosztorys header badge + accepted banner ✅
- Added StatusBadge to kosztorys breadcrumb header
- Added isAccepted prop to LockedBanner: permanent lock message, hides copy button
- Added status to ProjektInfo interface and select query

## AKC-008: Seed data ✅
- Reset Biuro Acme to draft with R0/R1 locked for manual flow testing
