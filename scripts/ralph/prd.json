{
  "project": "PLANY App",
  "branchName": "ralph/pozycje-ux-improvements",
  "description": "Pozycje UX improvements: breadcrumb, wider tabs/filters, server-side pagination, better layout",
  "mode": "feature",
  "baseBranch": "ralph/pozycje-filters-ux",
  "userStories": [
    {
      "id": "US-001",
      "title": "Add page param to filters schema and paginated getPozycje",
      "description": "As a developer, I need server-side pagination support so the pozycje list loads fast with large datasets.",
      "acceptanceCriteria": [
        "In lib/validations/pozycje.ts: add 'page' field (z.coerce.number().optional().default(1)) to pozycjeFiltersSchema",
        "In actions/pozycje.ts: change getPozycje return type to { data: Pozycja[], totalCount: number, page: number, pageSize: number }",
        "In getPozycje: use PAGE_SIZE=15, calculate offset as (page-1)*15",
        "Use .range(offset, offset + PAGE_SIZE - 1) on the Supabase query",
        "Add { count: 'exact' } option to the .select() call to get totalCount",
        "Return object with data, totalCount (from count), page, pageSize",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": "Also updated page.tsx minimally to destructure result.data so build passes. Exported PozycjeResult interface.",
      "dependsOn": []
    },
    {
      "id": "US-002",
      "title": "Update page.tsx to pass page param and new data shape",
      "description": "As a developer, I need page.tsx to read the page URL param and pass paginated data to PozycjeView.",
      "acceptanceCriteria": [
        "In app/(app)/pozycje/page.tsx: read 'page' from searchParams",
        "Pass page to filters object sent to getPozycje()",
        "Update PozycjeView props: pass totalCount, page, pageSize alongside initialData",
        "Handle the new return shape from getPozycje (destructure { data, totalCount, page, pageSize })",
        "When no branza selected, pass totalCount=0, page=1, pageSize=15",
        "Remove the <h1>Pozycje</h1> title entirely",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": "Removed h1 title. PozycjeView now accepts totalCount/page/pageSize props.",
      "dependsOn": ["US-001"]
    },
    {
      "id": "US-003",
      "title": "Add non-clickable breadcrumb to pozycje-view",
      "description": "As a user, I want to see a breadcrumb showing my current filter context instead of a plain title.",
      "acceptanceCriteria": [
        "In pozycje-view.tsx: add a breadcrumb row at the top, before FiltersComponent",
        "Breadcrumb row has breadcrumb on the left and 'Dodaj pozycje' button on the right (move button from filters)",
        "Breadcrumb format: 'Pozycje / BUD / 01 - Roboty rozbiórkowe / 01 - Rozkład podłogi'",
        "Segments separated by '/' in text-white/30",
        "Last segment in text-foreground, earlier segments in text-white/50",
        "Breadcrumb is display-only (not clickable)",
        "When no branza: just 'Pozycje'",
        "When branza only: 'Pozycje / BUD'",
        "When branza+kategoria: show kategoria name from initialData or pass kategoria/podkategoria names from server",
        "Use text-sm for the breadcrumb",
        "Remove onAddClick prop from PozycjeFilters since button moved to breadcrumb row",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 3,
      "passes": true,
      "notes": "Resolved category names via server-side lookup in page.tsx. Moved 'Dodaj pozycję' button to breadcrumb row. Removed onAddClick from PozycjeFilters.",
      "dependsOn": ["US-002"]
    },
    {
      "id": "US-004",
      "title": "Widen branza tabs to full-width with flex-1",
      "description": "As a user, I want the branza tabs to be wider and fill the available width.",
      "acceptanceCriteria": [
        "In pozycje-filters.tsx: change branza tabs container to full width (w-full)",
        "Each tab button uses flex-1 so they share width equally",
        "Increase padding to px-6 py-2.5 (was px-4 py-2)",
        "Keep same styling: amber glow active, hover effects",
        "Remove 'Dodaj pozycje' button from filters (already moved to breadcrumb row in US-003)",
        "Remove onAddClick prop from PozycjeFilters component",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 4,
      "passes": true,
      "notes": "Tabs now full-width with flex-1. Button already removed in US-003. Also restructured search/dropdowns into a single row below tabs (prep for US-005).",
      "dependsOn": ["US-003"]
    },
    {
      "id": "US-005",
      "title": "Widen filter dropdowns and put search + filters in one row",
      "description": "As a user, I want wider category dropdowns and all filters (search + kategoria + podkategoria) in a single row.",
      "acceptanceCriteria": [
        "In pozycje-filters.tsx: put search input, kategoria dropdown, and podkategoria dropdown in ONE flex row",
        "Search input takes flex-1 (fills remaining space)",
        "Kategoria dropdown width: w-[320px] (was w-[260px])",
        "Podkategoria dropdown width: w-[320px] (was w-[260px])",
        "Category dropdowns only show when branza is selected (same logic as now)",
        "When no branza selected, show only the search input at full width",
        "gap-3 between elements",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 5,
      "passes": true,
      "notes": "Search + kategoria + podkategoria in one flex row with gap-3. Dropdowns widened to 320px. Search takes flex-1.",
      "dependsOn": ["US-004"]
    },
    {
      "id": "US-006",
      "title": "Add pagination component below table",
      "description": "As a user, I want to see page numbers below the table to navigate between pages of 15 items.",
      "acceptanceCriteria": [
        "Create new file: app/(app)/pozycje/_components/pozycje-pagination.tsx",
        "Component is 'use client', receives: totalCount, page, pageSize as props",
        "Left side shows: 'Wyświetlanie 1-15 z 87' (calculated from page/pageSize/totalCount)",
        "Right side shows page buttons: [<] [1] [2] [3] ... [6] [>]",
        "Current page button highlighted with amber (bg-amber-500/15 text-amber-500)",
        "Other page buttons: text-white/50 hover:text-white/80 hover:bg-white/5",
        "Previous/Next buttons disabled at boundaries (opacity-50, pointer-events-none)",
        "Show max 5 page numbers with ellipsis (...) for long ranges",
        "Clicking a page updates URL param ?page=N using router.push",
        "Styled consistently with dark theme (bg-[#1A1A24]/40, border-white/[0.08])",
        "Pagination hidden when totalCount <= pageSize (only 1 page)",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 6,
      "passes": true,
      "notes": "Created pozycje-pagination.tsx with page numbers, ellipsis, prev/next buttons, amber active state.",
      "dependsOn": ["US-002"]
    },
    {
      "id": "US-007",
      "title": "Wire pagination into pozycje-view layout",
      "description": "As a developer, I need to integrate the pagination component into the pozycje-view layout.",
      "acceptanceCriteria": [
        "In pozycje-view.tsx: accept totalCount, page, pageSize as props",
        "Render PozycjePagination below the table (after the overflow-auto div)",
        "Pass totalCount, page, pageSize to PozycjePagination",
        "Do NOT show pagination when in empty state (no branza selected)",
        "Table height adjusted to account for pagination bar",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 7,
      "passes": true,
      "notes": "Pagination wired below table. Table height adjusted to account for pagination bar.",
      "dependsOn": ["US-006"]
    },
    {
      "id": "US-008",
      "title": "Final verification and build",
      "description": "As a developer, verify all pozycje UX improvements work together end-to-end.",
      "acceptanceCriteria": [
        "npm run build passes without errors",
        "Verify /pozycje: breadcrumb shows 'Pozycje', no h1 title, empty state shown",
        "Verify branza tabs are full-width and wider",
        "Verify selecting BUD: breadcrumb updates to 'Pozycje / BUD', table shows max 15 items",
        "Verify pagination appears with correct page count",
        "Verify clicking page 2 updates URL and shows next 15 items",
        "Verify search + kategoria + podkategoria dropdowns in one row",
        "Verify dropdowns are wider (320px)",
        "Verify selecting kategoria updates breadcrumb",
        "Verify Dodaj pozycje button is in breadcrumb row (right side)",
        "No console errors",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 8,
      "passes": true,
      "notes": "All stories complete. Build passes. Breadcrumb, wider tabs, wider dropdowns, search+filters row, pagination all working.",
      "dependsOn": ["US-003", "US-005", "US-007"]
    }
  ]
}
